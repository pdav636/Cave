<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Escape Plato's Cave</title>
    <style>
        body {
            margin: 0;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            height: 100vh;
            background-color: #1a1a1a;
            color: white;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            overflow: hidden;
        }

        #game-container {
            position: relative;
            width: 800px;
            height: 400px;
            background: linear-gradient(to right, #000 0%, #332211 50%, #87CEEB 100%);
            border: 4px solid #444;
            border-radius: 10px;
            overflow: hidden;
        }

        /* The Cave Wall / Shadows */
        #cave-elements {
            position: absolute;
            width: 100%;
            height: 100%;
            background-image: url('https://www.transparenttextures.com/patterns/rock.png');
            opacity: 0.4;
        }

        #player {
            position: absolute;
            bottom: 50px;
            left: 50px;
            font-size: 50px;
            transition: all 0.8s ease-in-out;
            z-index: 10;
        }

        #ui {
            margin-top: 20px;
            text-align: center;
            background: rgba(0, 0, 0, 0.8);
            padding: 20px;
            border-radius: 15px;
            width: 400px;
        }

        input {
            padding: 10px;
            font-size: 18px;
            width: 60px;
            border-radius: 5px;
            border: none;
            text-align: center;
        }

        button {
            padding: 10px 20px;
            font-size: 18px;
            background-color: #d4af37;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-left: 10px;
        }

        button:hover {
            background-color: #f1c40f;
        }

        #message {
            margin-top: 15px;
            font-style: italic;
            height: 20px;
        }

        .chains {
            position: absolute;
            bottom: 45px;
            left: 45px;
            font-size: 40px;
            opacity: 0.7;
        }
    </style>
</head>
<body>

    <h2>The Allegory of the Cave: The Journey to Truth</h2>
    <p>Answer 5 questions to break your chains and reach the sun.</p>

    <div id="game-container">
        <div id="cave-elements"></div>
        <div id="chains" class="chains">‚õìÔ∏è</div>
        <div id="player">üë§</div>
        
        <div style="position:absolute; right: 20px; top: 20px; font-size: 60px;">‚òÄÔ∏è</div>
    </div>

    <div id="ui">
        <div id="question-area">
            <h3 id="question-text">Loading question...</h3>
            <input type="number" id="answer-input" autofocus>
            <button onclick="checkAnswer()">Submit</button>
        </div>
        <div id="message"></div>
    </div>

    <script>
        let score = 0;
        let currentAns = 0;
        const player = document.getElementById('player');
        const chains = document.getElementById('chains');
        const qText = document.getElementById('question-text');
        const input = document.getElementById('answer-input');
        const message = document.getElementById('message');

        const quotes = [
            "You begin to see the shadows for what they are...",
            "The fire behind you is no longer the only light...",
            "The steep ascent begins. Your eyes ache...",
            "You see the reflections in the water...",
            "The Sun! You finally behold the source of all Truth."
        ];

        function generateQuestion() {
            const num1 = Math.floor(Math.random() * 12) + 1;
            const num2 = Math.floor(Math.random() * 12) + 1;
            currentAns = num1 + num2;
            qText.innerText = `What is ${num1} + ${num2}?`;
            input.value = "";
            input.focus();
        }

        function checkAnswer() {
            const userAns = parseInt(input.value);
            
            if (userAns === currentAns) {
                score++;
                movePlayer();
                if (score < 5) {
                    message.innerText = quotes[score - 1];
                    generateQuestion();
                } else {
                    winGame();
                }
            } else {
                message.innerText = "The shadows deceive you. Try again.";
            }
        }

        function movePlayer() {
            // Unchain on first correct answer
            if (score === 1) {
                chains.style.display = 'none';
                player.innerText = 'üèÉ';
            }
            
            // Calculate new position (50px start, moving toward ~700px)
            const newPos = 50 + (score * 130);
            player.style.left = newPos + "px";
            
            // Adjust "brightness" of the player based on progress
            player.style.filter = `brightness(${1 + (score * 0.5)})`;
        }

        function winGame() {
            document.getElementById('question-area').innerHTML = 
                "<h3>You have reached the Sunlight!</h3><button onclick='location.reload()'>Contemplate Again</button>";
            message.innerText = "You are no longer a prisoner of perception.";
            player.style.fontSize = "70px";
            player.innerText = "‚ú®üßò‚ú®";
        }

        // Listen for 'Enter' key
        input.addEventListener("keyup", function(event) {
            if (event.key === "Enter") {
                checkAnswer();
            }
        });

        generateQuestion();
    </script>
</body>
</html>
